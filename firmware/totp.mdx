---
title: "2FA - TOTP"
description: "Generate one-time codes securely and offline, right from your ZeroKeyUSB."
---

## What is TOTP?

TOTP stands for **Time-based One-Time Password** ‚Äî the same system used by apps like Google Authenticator or Authy.\
It generates a unique 6-digit code that changes every 30 seconds, proving that you have both:

1. Your password (something you know)  
2. Your ZeroKeyUSB (something you own)

Unlike phone apps, **ZeroKeyUSB performs this process completely offline**.\
The time reference and secret key are stored inside the device ‚Äî not in the cloud.

---

## How it works inside ZeroKeyUSB

Every TOTP code is computed locally by combining:

- A **Base32-encoded secret key** (unique per account, stored encrypted in the EEPROM)  
- The current **Unix time** (stored as an 8-byte binary epoch)  
- A cryptographic **hash algorithm** ‚Äî currently **SHA-1** following RFC 6238  

This produces a 6-digit code that is valid for 30 seconds.

TOTP = Truncate( HMAC-SHA1( secret , current_time / 30s ) )



Because the calculation is deterministic and offline, you get the same code any authenticator app would ‚Äî but generated entirely within your ZeroKeyUSB.

---

## Adding a 2FA secret

When you add a new account to ZeroKeyUSB, you can optionally include a **TOTP secret** (a Base32 string provided by the service you‚Äôre securing).\
This secret is automatically encrypted and saved in secure memory.

To import it:

1. Use the **local web manager** or compatible host tool.  
2. Paste or scan the `otpauth://` URI provided by the website or app (for example:\
   `otpauth://totp/MySite:user@example.com?secret=JBSWY3DPEHPK3PXP&issuer=MySite`).  
3. The **web manager** extracts the `secret=` value and sends it once over USB.  
4. ZeroKeyUSB then encrypts and stores it internally.

The secret is **never displayed** or stored in plain text.\
It is transmitted **only once locally** (never through the Internet) and encrypted immediately on receipt.

---

## Viewing your 2FA code

When a credential contains a TOTP secret, an extra line appears below the password field:

2FA ‚Üí Touch to view



Tapping the center point opens the TOTP view, where you‚Äôll see:

TOTP code: 123456
Expires in: 25 s



The countdown indicator refreshes every second.\
After 30 seconds, a new code is generated automatically.\
The TOTP screen closes automatically after a short period of inactivity to keep codes private.

> üß† You can use this code anywhere you‚Äôd use Google Authenticator ‚Äî it‚Äôs fully standard and compatible.

---

## Time synchronization

Since ZeroKeyUSB works offline, it doesn‚Äôt have an internal clock.\
Instead, it synchronizes **once** with your computer or phone through a simple USB command.

When the device needs to generate a code but time hasn‚Äôt been set, it shows:

Time not set
Request host time


At that moment, the host sends the current **Unix epoch time**.\
This value is stored in **plain binary** (not encrypted) and used as the base for future calculations.

> ‚è≥ You only need to resync after a factory reset or if the clock drifts by several minutes.

---

## Supported algorithms

ZeroKeyUSB currently supports **HMAC-SHA1**, the standard used by most 2FA providers.  
Support for **SHA-256** and **SHA-512** is planned for future firmware versions.

| Algorithm   | Status        | Typical use                             |
| ----------- | ------------- | --------------------------------------- |
| **SHA-1**   | ‚úÖ Implemented | Most services (Google, Microsoft, etc.) |
| **SHA-256** | ‚è≥ Planned     | Advanced security setups                |
| **SHA-512** | ‚è≥ Planned     | Enterprise-grade environments           |

---

## How TOTP is protected

| Layer                 | Description                                                                            |
| --------------------- | -------------------------------------------------------------------------------------- |
| **Encryption**        | Each secret is encrypted with **AES-128 CBC** using your Master PIN as the key.       |
| **Segmentation**      | TOTP data is stored in a dedicated 32-byte EEPROM page, isolated from credentials.     |
| **Metadata table**    | Each slot includes a 2-byte flag indicating whether a TOTP secret is active.           |
| **Offline operation** | No Wi-Fi, Bluetooth, or sync ‚Äî codes exist only inside your device.                    |
| **Verification**      | The firmware ensures all I¬≤C reads/writes complete successfully before decryption.     |
| **Tamper resistance** | Secrets cannot be extracted without the correct PIN and IV (Initialization Vector).    |

Even with physical access to the memory chip, it‚Äôs cryptographically infeasible to reconstruct your codes without your unique key and IV.

---

## Handling time drift

If a service rejects your code due to time differences:

- Open the **local web manager**.  
- Choose **Sync time** to resend the current epoch.  
- The new timestamp replaces the old one immediately.

---

## Advantages over phone authenticators

| Feature          | Phone app         | ZeroKeyUSB                 |
| ---------------- | ----------------- | -------------------------- |
| Internet access  | Required for sync | ‚ùå Offline only             |
| Cloud backup     | External service  | ‚ùå None ‚Äî encrypted locally |
| Malware exposure | Possible          | ‚úÖ Isolated firmware        |
| Screen privacy   | Shared device     | ‚úÖ Dedicated hardware       |
| Power source     | Battery dependent | ‚úÖ USB-powered              |
| Auditability     | Closed source     | ‚úÖ Fully open source        |

ZeroKeyUSB becomes your **personal authenticator**, integrated directly into the same secure device that holds your passwords.

---

## Good practices

- Add 2FA only for accounts you control ‚Äî avoid secrets from shared devices.  
- Back up credentials before performing a factory reset.  
- When prompted to ‚ÄúScan QR code‚Äù by a website, choose **Enter key manually** and paste the Base32 secret for ZeroKeyUSB import.  
- If codes drift from the server‚Äôs time, resync through the local web manager.

---

<Note>
ZeroKeyUSB‚Äôs TOTP engine follows the [RFC 6238 standard](https://datatracker.ietf.org/doc/html/rfc6238),\
the same open specification used by Google Authenticator and other mainstream 2FA tools ‚Äî implemented fully offline in hardware.
</Note>
